<!DOCTYPE html>
<html lang="en">
<head>
    
    <meta charset="utf-8">
    <title>Server - soundworks</title>
    
    <meta name="description" content="Documentation of soundworks, a full-stack JavaScript framework for distributed WebAudio and multimedia applications" />
    
    
    
    <script src="scripts/prettify/prettify.js"></script>
    <script src="scripts/prettify/lang-css.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc.css">
    <script src="scripts/nav.js" defer></script>
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
</head>
<body>

<input type="checkbox" id="nav-trigger" class="nav-trigger" />
<label for="nav-trigger" class="navicon-button x">
  <div class="navicon"></div>
</label>

<label for="nav-trigger" class="overlay"></label>

<nav >
    
    <input type="text" id="nav-search" placeholder="Search" />
    
    
    <h2><a href="index.html">Home</a></h2><h2><a href="http://soundworks.dev/" target="_blank" class="menu-item" >Website</a></h2><h2><a href="https://github.com/collective-soundworks/soundworks" target="_blank" class="menu-item" >Github</a></h2><h3>Classes</h3><ul><li><a href="Client.html">Client</a><ul class='methods'><li data-type='method'><a href="Client.html#getAuditState">getAuditState</a></li><li data-type='method'><a href="Client.html#init">init</a></li><li data-type='method'><a href="Client.html#onStatusChange">onStatusChange</a></li><li data-type='method'><a href="Client.html#start">start</a></li><li data-type='method'><a href="Client.html#stop">stop</a></li></ul></li><li><a href="ClientContext.html">ClientContext</a><ul class='methods'><li data-type='method'><a href="ClientContext.html#enter">enter</a></li><li data-type='method'><a href="ClientContext.html#exit">exit</a></li><li data-type='method'><a href="ClientContext.html#start">start</a></li><li data-type='method'><a href="ClientContext.html#stop">stop</a></li></ul></li><li><a href="ClientContextManager.html">ClientContextManager</a><ul class='methods'><li data-type='method'><a href="ClientContextManager.html#get">get</a></li></ul></li><li><a href="ClientPluginManager.html">ClientPluginManager</a><ul class='methods'><li data-type='method'><a href="ClientPluginManager.html#addDependency">addDependency</a></li><li data-type='method'><a href="ClientPluginManager.html#get">get</a></li><li data-type='method'><a href="ClientPluginManager.html#getRegisteredPlugins">getRegisteredPlugins</a></li><li data-type='method'><a href="ClientPluginManager.html#getUnsafe">getUnsafe</a></li><li data-type='method'><a href="ClientPluginManager.html#onStateChange">onStateChange</a></li><li data-type='method'><a href="ClientPluginManager.html#register">register</a></li></ul></li><li><a href="ClientSocket.html">ClientSocket</a><ul class='methods'><li data-type='method'><a href="ClientSocket.html#addListener">addListener</a></li><li data-type='method'><a href="ClientSocket.html#removeAllListeners">removeAllListeners</a></li><li data-type='method'><a href="ClientSocket.html#removeListener">removeListener</a></li><li data-type='method'><a href="ClientSocket.html#send">send</a></li></ul></li><li><a href="ClientStateManager.html">ClientStateManager</a><ul class='methods'><li data-type='method'><a href="ClientStateManager.html#attach">attach</a></li><li data-type='method'><a href="ClientStateManager.html#create">create</a></li><li data-type='method'><a href="ClientStateManager.html#getClassDescription">getClassDescription</a></li><li data-type='method'><a href="ClientStateManager.html#getCollection">getCollection</a></li><li data-type='method'><a href="ClientStateManager.html#getSchema">getSchema</a></li><li data-type='method'><a href="ClientStateManager.html#observe">observe</a></li></ul></li><li><a href="Server.html">Server</a><ul class='methods'><li data-type='method'><a href="Server.html#generateAuthToken">generateAuthToken</a></li><li data-type='method'><a href="Server.html#getAuditState">getAuditState</a></li><li data-type='method'><a href="Server.html#init">init</a></li><li data-type='method'><a href="Server.html#isTrustedClient">isTrustedClient</a></li><li data-type='method'><a href="Server.html#isTrustedToken">isTrustedToken</a></li><li data-type='method'><a href="Server.html#onStatusChange">onStatusChange</a></li><li data-type='method'><a href="Server.html#start">start</a></li><li data-type='method'><a href="Server.html#stop">stop</a></li><li data-type='method'><a href="Server.html#useDefaultApplicationTemplate">useDefaultApplicationTemplate</a></li></ul></li><li><a href="ServerClient.html">ServerClient</a></li><li><a href="ServerContext.html">ServerContext</a><ul class='methods'><li data-type='method'><a href="ServerContext.html#enter">enter</a></li><li data-type='method'><a href="ServerContext.html#exit">exit</a></li><li data-type='method'><a href="ServerContext.html#start">start</a></li><li data-type='method'><a href="ServerContext.html#stop">stop</a></li></ul></li><li><a href="ServerContextManager.html">ServerContextManager</a><ul class='methods'><li data-type='method'><a href="ServerContextManager.html#get">get</a></li></ul></li><li><a href="ServerPluginManager.html">ServerPluginManager</a><ul class='methods'><li data-type='method'><a href="ServerPluginManager.html#addDependency">addDependency</a></li><li data-type='method'><a href="ServerPluginManager.html#get">get</a></li><li data-type='method'><a href="ServerPluginManager.html#getRegisteredPlugins">getRegisteredPlugins</a></li><li data-type='method'><a href="ServerPluginManager.html#getUnsafe">getUnsafe</a></li><li data-type='method'><a href="ServerPluginManager.html#onStateChange">onStateChange</a></li><li data-type='method'><a href="ServerPluginManager.html#register">register</a></li></ul></li><li><a href="ServerSocket.html">ServerSocket</a><ul class='methods'><li data-type='method'><a href="ServerSocket.html#addListener">addListener</a></li><li data-type='method'><a href="ServerSocket.html#removeAllListeners">removeAllListeners</a></li><li data-type='method'><a href="ServerSocket.html#removeListener">removeListener</a></li><li data-type='method'><a href="ServerSocket.html#send">send</a></li></ul></li><li><a href="ServerSockets.html">ServerSockets</a></li><li><a href="ServerStateManager.html">ServerStateManager</a><ul class='methods'><li data-type='method'><a href="ServerStateManager.html#attach">attach</a></li><li data-type='method'><a href="ServerStateManager.html#create">create</a></li><li data-type='method'><a href="ServerStateManager.html#defineClass">defineClass</a></li><li data-type='method'><a href="ServerStateManager.html#deleteClass">deleteClass</a></li><li data-type='method'><a href="ServerStateManager.html#deleteSchema">deleteSchema</a></li><li data-type='method'><a href="ServerStateManager.html#getClassDescription">getClassDescription</a></li><li data-type='method'><a href="ServerStateManager.html#getCollection">getCollection</a></li><li data-type='method'><a href="ServerStateManager.html#getSchema">getSchema</a></li><li data-type='method'><a href="ServerStateManager.html#observe">observe</a></li><li data-type='method'><a href="ServerStateManager.html#registerCreateHook">registerCreateHook</a></li><li data-type='method'><a href="ServerStateManager.html#registerDeleteHook">registerDeleteHook</a></li><li data-type='method'><a href="ServerStateManager.html#registerSchema">registerSchema</a></li><li data-type='method'><a href="ServerStateManager.html#registerUpdateHook">registerUpdateHook</a></li></ul></li><li><a href="SharedState.html">SharedState</a><ul class='methods'><li data-type='method'><a href="SharedState.html#delete">delete</a></li><li data-type='method'><a href="SharedState.html#detach">detach</a></li><li data-type='method'><a href="SharedState.html#get">get</a></li><li data-type='method'><a href="SharedState.html#getDefaults">getDefaults</a></li><li data-type='method'><a href="SharedState.html#getDescription">getDescription</a></li><li data-type='method'><a href="SharedState.html#getInitValues">getInitValues</a></li><li data-type='method'><a href="SharedState.html#getSchema">getSchema</a></li><li data-type='method'><a href="SharedState.html#getUnsafe">getUnsafe</a></li><li data-type='method'><a href="SharedState.html#getValues">getValues</a></li><li data-type='method'><a href="SharedState.html#getValuesUnsafe">getValuesUnsafe</a></li><li data-type='method'><a href="SharedState.html#onDelete">onDelete</a></li><li data-type='method'><a href="SharedState.html#onDetach">onDetach</a></li><li data-type='method'><a href="SharedState.html#onUpdate">onUpdate</a></li><li data-type='method'><a href="SharedState.html#set">set</a></li></ul></li><li><a href="SharedStateCollection.html">SharedStateCollection</a><ul class='methods'><li data-type='method'><a href="SharedStateCollection.html#detach">detach</a></li><li data-type='method'><a href="SharedStateCollection.html#filter">filter</a></li><li data-type='method'><a href="SharedStateCollection.html#find">find</a></li><li data-type='method'><a href="SharedStateCollection.html#forEach">forEach</a></li><li data-type='method'><a href="SharedStateCollection.html#get">get</a></li><li data-type='method'><a href="SharedStateCollection.html#getDefaults">getDefaults</a></li><li data-type='method'><a href="SharedStateCollection.html#getDescription">getDescription</a></li><li data-type='method'><a href="SharedStateCollection.html#getSchema">getSchema</a></li><li data-type='method'><a href="SharedStateCollection.html#getUnsafe">getUnsafe</a></li><li data-type='method'><a href="SharedStateCollection.html#getValues">getValues</a></li><li data-type='method'><a href="SharedStateCollection.html#getValuesUnsafe">getValuesUnsafe</a></li><li data-type='method'><a href="SharedStateCollection.html#map">map</a></li><li data-type='method'><a href="SharedStateCollection.html#onAttach">onAttach</a></li><li data-type='method'><a href="SharedStateCollection.html#onChange">onChange</a></li><li data-type='method'><a href="SharedStateCollection.html#onDetach">onDetach</a></li><li data-type='method'><a href="SharedStateCollection.html#onUpdate">onUpdate</a></li><li data-type='method'><a href="SharedStateCollection.html#reduce">reduce</a></li><li data-type='method'><a href="SharedStateCollection.html#set">set</a></li><li data-type='method'><a href="SharedStateCollection.html#sort">sort</a></li></ul></li><li><a href="module.exports.html">module.exports</a><ul class='methods'><li data-type='method'><a href="module.exports.html#onStateChange">onStateChange</a></li><li data-type='method'><a href="module.exports.html#propagateStateChange">propagateStateChange</a></li><li data-type='method'><a href="module.exports.html#start">start</a></li><li data-type='method'><a href="module.exports.html#stop">stop</a></li></ul></li><li></li></ul><h3>Global</h3><ul><li><a href="global.html#ClientAppConfig">ClientAppConfig</a></li><li><a href="global.html#ClientConfig">ClientConfig</a></li><li><a href="global.html#ClientDescription">ClientDescription</a></li><li><a href="global.html#ClientEnvConfig">ClientEnvConfig</a></li><li><a href="global.html#ClientRole">ClientRole</a></li><li><a href="global.html#ServerAppConfig">ServerAppConfig</a></li><li><a href="global.html#ServerConfig">ServerConfig</a></li><li><a href="global.html#ServerEnvConfig">ServerEnvConfig</a></li><li><a href="global.html#SharedStateClassDescription">SharedStateClassDescription</a></li><li><a href="global.html#SharedStateClassName">SharedStateClassName</a></li><li><a href="global.html#SharedStateParameterDescription">SharedStateParameterDescription</a></li><li><a href="global.html#SharedStateParameterName">SharedStateParameterName</a></li><li><a href="global.html#addClient">addClient</a></li><li><a href="global.html#client">client</a></li><li><a href="global.html#clients">clients</a></li><li><a href="global.html#pluginDeleteOnStateChangeCallback">pluginDeleteOnStateChangeCallback</a></li><li><a href="global.html#pluginManagerDeleteOnStateChangeCallback">pluginManagerDeleteOnStateChangeCallback</a></li><li><a href="global.html#pluginManagerOnStateChangeCallback">pluginManagerOnStateChangeCallback</a></li><li><a href="global.html#pluginOnStateChangeCallback">pluginOnStateChangeCallback</a></li><li><a href="global.html#removeClient">removeClient</a></li><li><a href="global.html#server">server</a></li><li><a href="global.html#serverStateManagerCreateHook">serverStateManagerCreateHook</a></li><li><a href="global.html#serverStateManagerDeleteHook">serverStateManagerDeleteHook</a></li><li><a href="global.html#serverStateManagerUpdateHook">serverStateManagerUpdateHook</a></li><li><a href="global.html#sharedStateCollectionDeleteOnAttachCallback">sharedStateCollectionDeleteOnAttachCallback</a></li><li><a href="global.html#sharedStateCollectionDeleteOnChangeCallback">sharedStateCollectionDeleteOnChangeCallback</a></li><li><a href="global.html#sharedStateCollectionDeleteOnDetachCallback">sharedStateCollectionDeleteOnDetachCallback</a></li><li><a href="global.html#sharedStateCollectionDeleteOnUpdateCallback">sharedStateCollectionDeleteOnUpdateCallback</a></li><li><a href="global.html#sharedStateCollectionOnAttachCallback">sharedStateCollectionOnAttachCallback</a></li><li><a href="global.html#sharedStateCollectionOnChangeCallback">sharedStateCollectionOnChangeCallback</a></li><li><a href="global.html#sharedStateCollectionOnDetachCallback">sharedStateCollectionOnDetachCallback</a></li><li><a href="global.html#sharedStateCollectionOnUpdateCallback">sharedStateCollectionOnUpdateCallback</a></li><li><a href="global.html#sharedStateDeleteOnUpdateCallback">sharedStateDeleteOnUpdateCallback</a></li><li><a href="global.html#sharedStateOnUpdateCallback">sharedStateOnUpdateCallback</a></li><li><a href="global.html#stateManagerDeleteObserveCallback">stateManagerDeleteObserveCallback</a></li><li><a href="global.html#stateManagerObserveCallback">stateManagerObserveCallback</a></li></ul>
    
</nav>

<div id="main">
    
    <h1 class="page-title">Server</h1>
    

    




<section>

<header>
    
        <h2>
        
            Server
        
        </h2>
        
            <div class="class-description usertext"><p>The <code>Server</code> class is the main entry point for soundworks server-side project.</p>
<p>The <code>Server</code> instance allows to access soundworks components such as <a href="ServerStateManager.html">ServerStateManager</a>,
<a href="ServerPluginManager.html">ServerPluginManager</a>, <a href="ServerSocket.html">ServerSocket</a> or <a href="ServerContextManager.html">ServerContextManager</a>.
Its is also responsible for handling the initialization lifecycle of the different
soundworks components.</p>
<pre class="prettyprint source"><code>import { Server } from '@soundworks/core/server';

const server = new Server({
  app: {
    name: 'my-example-app',
    clients: {
      player: { runtime: 'browser', default: true },
      controller: { runtime: 'browser' },
      thing: { runtime: 'node' }
    },
  },
  env: {
    port: 8000,
  },
});

await server.start();
</code></pre></div>
        
    
</header>

<article>
    
        <div class="container-overview">
        
            

    
    <h2>Constructor</h2>
    

    <h4 class="name" id="Server"><span class="type-signature"></span>new Server<span class="signature">(config)</span><span class="type-signature"></span></h4>

    




<dl class="details">
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line125">line 125</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>













    <h5 class="h5-parameters">Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>config</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="global.html#ServerConfig">ServerConfig</a></span>



            
            </td>

            

            

            <td class="description last"><p>Configuration object for the server.</p></td>
        </tr>

    
    </tbody>
</table>














<h5 class="h5-throws">Throws:</h5>

        

    <div class="param-desc usertext">
    
        <ul>
<li>If <code>config.app.clients</code> is empty.</li>
<li>If a <code>node</code> client is defined but <code>config.env.serverAddress</code> is not defined.</li>
<li>if <code>config.env.useHttps</code> is <code>true</code> and <code>config.env.httpsInfos</code> is not <code>null</code>
(which generates self signed certificated), <code>config.env.httpsInfos.cert</code> and
<code>config.env.httpsInfos.key</code> should point to valid cert files.</li>
</ul>
    
    </div>


    





        
        </div>
    

    

    

    
    
    

     

    

    
        <h3 class="subsection-title">Members</h3>

        
            
<h4 class="name" id="config"><span class="type-signature"></span>config<span class="type-signature"> :<a href="global.html#ServerConfig">ServerConfig</a></span></h4>





<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Given config object merged with the following defaults:</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line267">line 267</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Given config object merged with the following defaults:</p>
</div>



    <h5 class="h5-types">Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><a href="global.html#ServerConfig">ServerConfig</a></span>



        </li>
    </ul>





    <h5 class="h5-examples">Example</h5>
    
    <pre class="prettyprint"><code>{
  env: {
    type: 'development',
    port: 8000,
    serverAddress: null,
    baseUrl: '',
    useHttps: false,
    httpsInfos: null,
    crossOriginIsolated: true,
    verbose: true,
  },
  app: {
    name: 'soundworks',
    clients: {},
  }
}</code></pre>



        
            
<h4 class="name" id="contextManager"><span class="type-signature"></span>contextManager<span class="type-signature"> :<a href="ServerContextManager.html">ServerContextManager</a></span></h4>





<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Instance of the <a href="ServerContextManager.html">ServerContextManager</a> class.</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line386">line 386</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Instance of the <a href="ServerContextManager.html">ServerContextManager</a> class.</p>
</div>



    <h5 class="h5-types">Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><a href="ServerContextManager.html">ServerContextManager</a></span>



        </li>
    </ul>






        
            
<h4 class="name" id="db"><span class="type-signature"></span>db<span class="type-signature"></span></h4>





<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Simple key / value filesystem database with Promise based Map API.</p>
<p>Basically a tiny wrapper around the <a href="https://github.com/lukechilds/keyv">https://github.com/lukechilds/keyv</a> package.</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line350">line 350</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Simple key / value filesystem database with Promise based Map API.</p>
<p>Basically a tiny wrapper around the <a href="https://github.com/lukechilds/keyv">https://github.com/lukechilds/keyv</a> package.</p>
</div>








        
            
<h4 class="name" id="httpServer"><span class="type-signature"></span>httpServer<span class="type-signature"></span></h4>





<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Instance of the Node.js <code>http.Server</code> or <code>https.Server</code></p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line341">line 341</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-see">See:</dt>
    <dd class="tag-see">
        <ul>
            <li><a href="https://nodejs.org/api/http.html#class-httpserver">https://nodejs.org/api/http.html#class-httpserver</a></li>
        
            <li><a href="https://nodejs.org/api/https.html#class-httpsserver">https://nodejs.org/api/https.html#class-httpsserver</a></li>
        </ul>
    </dd>
    

    
</dl>





<div class="description usertext">
    <p>Instance of the Node.js <code>http.Server</code> or <code>https.Server</code></p>
</div>








        
            
<h4 class="name" id="id"><span class="type-signature type-signature-readonly">(readonly) </span>id<span class="type-signature"> :number</span></h4>





<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Id of the server, a constant set to <code>-1</code></p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line285">line 285</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Id of the server, a constant set to <code>-1</code></p>
</div>



    <h5 class="h5-types">Type:</h5>
    <ul>
        <li>
            
<span class="param-type">number</span>



        </li>
    </ul>






        
            
<h4 class="name" id="pluginManager"><span class="type-signature"></span>pluginManager<span class="type-signature"> :<a href="ServerPluginManager.html">ServerPluginManager</a></span></h4>





<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Instance of the <a href="ServerPluginManager.html">ServerPluginManager</a> class.</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line368">line 368</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Instance of the <a href="ServerPluginManager.html">ServerPluginManager</a> class.</p>
</div>



    <h5 class="h5-types">Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><a href="ServerPluginManager.html">ServerPluginManager</a></span>



        </li>
    </ul>






        
            
<h4 class="name" id="router"><span class="type-signature"></span>router<span class="type-signature"></span></h4>





<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Instance of the router if any.</p>
<p>The router can be used to open new route, for example to expose a directory
of static assets (in default soundworks applications only the <code>public</code> is exposed).</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line316">line 316</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Instance of the router if any.</p>
<p>The router can be used to open new route, for example to expose a directory
of static assets (in default soundworks applications only the <code>public</code> is exposed).</p>
</div>







    <h5 class="h5-examples">Example</h5>
    
    <pre class="prettyprint"><code>import { Server } from '@soundworks/core/server.js';
import { loadConfig, configureHttpRouter } from '@soundworks/helpers/server.js';

// create the server instance
const server = new Server(loadConfig());
// configure the express router provided by the helpers
configureHttpRouter(server);

// expose assets located in the `soundfiles` directory on the network
server.router.use('/soundfiles', express.static('soundfiles')));</code></pre>



        
            
<h4 class="name" id="sockets"><span class="type-signature"></span>sockets<span class="type-signature"> :<a href="ServerSockets.html">ServerSockets</a></span></h4>





<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Instance of the <a href="ServerSockets.html">ServerSockets</a> class.</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line359">line 359</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Instance of the <a href="ServerSockets.html">ServerSockets</a> class.</p>
</div>



    <h5 class="h5-types">Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><a href="ServerSockets.html">ServerSockets</a></span>



        </li>
    </ul>






        
            
<h4 class="name" id="stateManager"><span class="type-signature"></span>stateManager<span class="type-signature"> :<a href="ServerStateManager.html">ServerStateManager</a></span></h4>





<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Instance of the <a href="ServerStateManager.html">ServerStateManager</a> class.</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line377">line 377</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Instance of the <a href="ServerStateManager.html">ServerStateManager</a> class.</p>
</div>



    <h5 class="h5-types">Type:</h5>
    <ul>
        <li>
            
<span class="param-type"><a href="ServerStateManager.html">ServerStateManager</a></span>



        </li>
    </ul>






        
            
<h4 class="name" id="status"><span class="type-signature"></span>status<span class="type-signature"> :'idle'|'inited'|'started'|'errored'</span></h4>





<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Status of the server.</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line294">line 294</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Status of the server.</p>
</div>



    <h5 class="h5-types">Type:</h5>
    <ul>
        <li>
            
<span class="param-type">'idle'</span>
|

<span class="param-type">'inited'</span>
|

<span class="param-type">'started'</span>
|

<span class="param-type">'errored'</span>



        </li>
    </ul>






        
            
<h4 class="name" id="version"><span class="type-signature"></span>version<span class="type-signature"> :string</span></h4>





<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Package version.</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line276">line 276</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>





<div class="description usertext">
    <p>Package version.</p>
</div>



    <h5 class="h5-types">Type:</h5>
    <ul>
        <li>
            
<span class="param-type">string</span>



        </li>
    </ul>






        
    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    <h4 class="name" id="generateAuthToken"><span class="type-signature"></span>generateAuthToken<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Generate a token to secure client connection.</p>
<p>The token should be passed to the client-side <code>Client</code> config object, it will
be internally used to check the WebSocket connection and reject it if the
token is invalid.</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line759">line 759</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>






























        
            

    

    <h4 class="name" id="getAuditState"><span class="type-signature type-signature-async">(async) </span>getAuditState<span class="signature">()</span><span class="type-signature"> &rarr; {Promise.&lt;<a href="SharedState.html">SharedState</a>>}</span></h4>

    




<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Attach and retrieve the global audit state of the application.</p>
<p>The audit state is a <a href="SharedState.html">SharedState</a> instance that keeps track of
global information about the application such as, the number of connected
clients, network latency estimation, etc.</p>
<p>The audit state is created by the server on start up.</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line442">line 442</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>











    <h5 class="h5-examples">Example</h5>
    
    <pre class="prettyprint"><code>const auditState = await server.getAuditState();
auditState.onUpdate(() => console.log(auditState.getValues()), true);</code></pre>
















<h5 class="h5-throws">Throws:</h5>

        

    <div class="param-desc usertext">
    
        <p>Will throw if called before <code>server.init()</code></p>
    
    </div>


    


<h5 class="h5-returns">Returns:</h5>

        


<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;<a href="SharedState.html">SharedState</a>></span>



    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="init"><span class="type-signature type-signature-async">(async) </span>init<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>The <code>init</code> method is part of the initialization lifecycle of the <code>soundworks</code>
server. Most of the time, the <code>init</code> method will be implicitly called by the
<a href="Server.html#start">Server#start</a> method.</p>
<p>In some situations you might want to call this method manually, in such cases
the method should be called before the <a href="Server.html#start">Server#start</a> method.</p>
<p>What it does:</p>
<ol>
<li>Create the audit state</li>
<li>Create the HTTP(s) server</li>
<li>Initialize registered plugins</li>
</ol>
<p>Between steps 2 and 3, the 'http-server-ready' event status is dispatched so
that consumer code can register its router before plugin initialization:</p>
<pre class="prettyprint source lang-js"><code>server.onStatusChange(status => {
  if (status === 'http-server-ready') {
    server.httpServer.on('request', router);
  }
});
</code></pre>
<p>After <code>await server.init()</code> is fulfilled, the <a href="Server.html#stateManager">Server#stateManager</a>
and all registered plugins can be safely used.</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line484">line 484</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>











    <h5 class="h5-examples">Example</h5>
    
    <pre class="prettyprint"><code>const server = new Server(config);
await server.init();
await server.start();
// or implicitly called by start
const server = new Server(config);
await server.start(); // init is called implicitly</code></pre>





















        
            

    

    <h4 class="name" id="isTrustedClient"><span class="type-signature"></span>isTrustedClient<span class="signature">(client)</span><span class="type-signature"> &rarr; {boolean}</span></h4>

    




<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Check if the given client is trusted, i.e. config.env.type == 'production'
and the client is protected behind a password.</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line801">line 801</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>













    <h5 class="h5-parameters">Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>client</code></td>
            

            <td class="type">
            
                
<span class="param-type"><a href="ServerClient.html">ServerClient</a></span>



            
            </td>

            

            

            <td class="description last"><p>Client to be tested</p></td>
        </tr>

    
    </tbody>
</table>
















<h5 class="h5-returns">Returns:</h5>

        


<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>



    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="isTrustedToken"><span class="type-signature"></span>isTrustedToken<span class="signature">(clientId, clientIp, token)</span><span class="type-signature"> &rarr; {boolean}</span></h4>

    




<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Check if the token from a client is trusted, i.e. config.env.type == 'production'
and the client is protected behind a password.</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line819">line 819</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>













    <h5 class="h5-parameters">Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>clientId</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>



            
            </td>

            

            

            <td class="description last"><p>Id of the client</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>clientIp</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>



            
            </td>

            

            

            <td class="description last"><p>Ip of the client</p></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>token</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>



            
            </td>

            

            

            <td class="description last"><p>Token to be tested</p></td>
        </tr>

    
    </tbody>
</table>
















<h5 class="h5-returns">Returns:</h5>

        


<dl class="param-type">
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">boolean</span>



    </dd>
</dl>

    



        
            

    

    <h4 class="name" id="onStatusChange"><span class="type-signature"></span>onStatusChange<span class="signature">(callback)</span><span class="type-signature"></span></h4>

    




<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Register a callback to execute when status change.</p>
<p>Status are dispatched in the following order:</p>
<ul>
<li>'http-server-ready'</li>
<li>'inited'</li>
<li>'started'</li>
<li>'stopped'
during the lifecycle of the server. If an error occurs the 'errored' status is propagated.</li>
</ul></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line421">line 421</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>













    <h5 class="h5-parameters">Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>callback</code></td>
            

            <td class="type">
            
                
<span class="param-type">function</span>



            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>



















        
            

    

    <h4 class="name" id="start"><span class="type-signature type-signature-async">(async) </span>start<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>The <code>start</code> method is part of the initialization lifecycle of the <code>soundworks</code>
server. The <code>start</code> method will implicitly call the <a href="Server.html#init">Server#init</a>
method if it has not been called manually.</p>
<p>What it does:</p>
<ul>
<li>implicitly call <a href="Server.html#init">Server#init</a> if not done manually</li>
<li>launch the HTTP and WebSocket servers</li>
<li>start all created contexts. To this end, you will have to call <code>server.init</code>
manually and instantiate the contexts between <code>server.init()</code> and <code>server.start()</code></li>
</ul>
<p>After <code>await server.start()</code> the server is ready to accept incoming connections</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line544">line 544</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>











    <h5 class="h5-examples">Example</h5>
    
    <pre class="prettyprint"><code>import { Server } from '@soundworks/core/server.js'

const server = new Server(config);
await server.start();</code></pre>





















        
            

    

    <h4 class="name" id="stop"><span class="type-signature type-signature-async">(async) </span>stop<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">
    
    <dt class="tag-description">Description:</dt>
    <dd class="tag-description"><ul class="dummy"><li><p>Stops all started contexts, plugins, close all the socket connections and
the http(s) server.</p>
<p>In most situations, you might not need to call this method. However, it can
be useful for unit testing or similar situations where you want to create
and delete several servers in the same process.</p></li></ul></dd>
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line603">line 603</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    

    

    

    

    

    

    

    
</dl>











    <h5 class="h5-examples">Example</h5>
    
    <pre class="prettyprint"><code>import { Server } from '@soundworks/core/server.js'

const server = new Server(config);
await server.start();

await new Promise(resolve => setTimeout(resolve, 1000));
await server.stop();</code></pre>





















        
            

    

    <h4 class="name" id="useDefaultApplicationTemplate"><span class="type-signature"></span>useDefaultApplicationTemplate<span class="signature">()</span><span class="type-signature"></span></h4>

    




<dl class="details">
    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="server_Server.js.html">server/Server.js</a>, <a href="server_Server.js.html#line871">line 871</a>
    </li></ul></dd>
    

    

    

    

    

    

    

    

    
        <dt class="important tag-deprecated">Deprecated:</dt><dd class="yes-def tag-deprecated"><ul class="dummy"><li>Yes</li></ul></dd>
    

    

    

    

    

    

    

    
</dl>






























        
    

    

    
</article>

</section>




    
    
</div>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 4.0.4</a> on Wed Feb 19 2025 15:57:31 GMT+0000 (Coordinated Universal Time) using the <a href="https://github.com/clenemt/docdash">docdash</a> theme.
</footer>

<script>prettyPrint();</script>
<script src="scripts/polyfill.js"></script>
<script src="scripts/linenumber.js"></script>

<script src="scripts/search.js" defer></script>



    <link type="text/css" rel="stylesheet" href="assets/custom.css">
    
</body>
</html>